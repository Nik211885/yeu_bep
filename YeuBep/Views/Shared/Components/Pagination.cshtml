@model YeuBep.ViewModels.PaginationViewModel

@{
    var queryParams = string.Join("&", Context.Request.Query.Where(q => q.Key != "pageNumber").Select(q => $"{q.Key}={q.Value}"));
    var hasQueryParams = !string.IsNullOrEmpty(queryParams);
    var separator = hasQueryParams ? "&" : "";
}

@if (Model.TotalPages > 1)
{
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center p-0 m-0">
            <li class="page-item @(!Model.HasPreviousPage ? "disabled" : "")">
                <a class="page-link" 
                   href="?@(queryParams)@(separator)pageNumber=@(Model.PageNumber - 1)" 
                   aria-label="Previous"
                   @(!Model.HasPreviousPage ? "tabindex=-1" : "")>
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>

            @{
                int startPage = Math.Max(1, Model.PageNumber - 2);
                int endPage = Math.Min(Model.TotalPages, Model.PageNumber + 2);
                
                if (startPage > 1)
                {
                    <li class="page-item">
                        <a class="page-link" href="?@(queryParams)@(separator)pageNumber=1">1</a>
                    </li>
                    if (startPage > 2)
                    {
                        <li class="page-item disabled">
                            <span class="page-link">...</span>
                        </li>
                    }
                }
                for (int i = startPage; i <= endPage; i++)
                {
                    <li class="page-item @(i == Model.PageNumber ? "active" : "")">
                        <a class="page-link" href="?@(queryParams)@(separator)pageNumber=@i">
                            @i
                            @if (i == Model.PageNumber)
                            {
                                <span class="sr-only">(current)</span>
                            }
                        </a>
                    </li>
                }
                if (endPage < Model.TotalPages)
                {
                    if (endPage < Model.TotalPages - 1)
                    {
                        <li class="page-item disabled">
                            <span class="page-link">...</span>
                        </li>
                    }
                    <li class="page-item">
                        <a class="page-link" href="?@(queryParams)@(separator)pageNumber=@Model.TotalPages">@Model.TotalPages</a>
                    </li>
                }
            }
            <li class="page-item @(!Model.HasNextPage ? "disabled" : "")">
                <a class="page-link" 
                   href="?@(queryParams)@(separator)pageNumber=@(Model.PageNumber + 1)" 
                   aria-label="Next"
                   @(!Model.HasNextPage ? "tabindex=-1" : "")>
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
    
    <div class="text-center text-muted">
        <small>
            Hiển thị @((Model.PageNumber - 1) * Model.PageSize + 1) - @(Math.Min(Model.PageNumber * Model.PageSize, Model.TotalCount)) 
            trong tổng số @Model.TotalCount kết quả
        </small>
    </div>
}